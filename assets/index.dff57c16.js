var de=Object.defineProperty,pe=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var ae=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var re=(d,m,h)=>m in d?de(d,m,{enumerable:!0,configurable:!0,writable:!0,value:h}):d[m]=h,le=(d,m)=>{for(var h in m||(m={}))he.call(m,h)&&re(d,h,m[h]);if(ae)for(var h of ae(m))me.call(m,h)&&re(d,h,m[h]);return d},ue=(d,m)=>pe(d,fe(m));import{v as ye,e as ve,f as R,g as ge,h as be,r as x,o as U,j as X,k as ke,l as f,w as _,u as ce,b as Y,t as we,m as ee,n as te}from"./vendor.655743c6.js";var _e=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Oe(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}function Ce(d){if(d.__esModule)return d;var m=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(d).forEach(function(h){var E=Object.getOwnPropertyDescriptor(d,h);Object.defineProperty(m,h,E.get?E:{enumerable:!0,get:function(){return d[h]}})}),m}var se={exports:{}},je=Ce(ye);(function(d,m){(function(h,E){d.exports=E(je)})(_e,function(h){return function(){var E={452:function(o){o.exports=h}},q={};function g(o){var c=q[o];if(c!==void 0)return c.exports;var B=q[o]={exports:{}};return E[o](B,B.exports,g),B.exports}g.d=function(o,c){for(var B in c)g.o(c,B)&&!g.o(o,B)&&Object.defineProperty(o,B,{enumerable:!0,get:c[B]})},g.o=function(o,c){return Object.prototype.hasOwnProperty.call(o,c)},g.r=function(o){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})};var F={};return function(){g.r(F),g.d(F,{default:function(){return W}});var o=g(452);function c(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function B(e,t){if(e){if(typeof e=="string")return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function z(e,t){return function(n){if(Array.isArray(n))return n}(e)||function(n,a){var u=n==null?null:typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(u!=null){var k,y,C=[],w=!0,r=!1;try{for(u=u.call(n);!(w=(k=u.next()).done)&&(C.push(k.value),!a||C.length!==a);w=!0);}catch(l){r=!0,y=l}finally{try{w||u.return==null||u.return()}finally{if(r)throw y}}return C}}(e,t)||B(e,t)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function J(e){return function(t){if(Array.isArray(t))return c(t)}(e)||function(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}(e)||B(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=(0,o.defineComponent)({props:{data:{required:!0,type:String},onClick:Function},render:function(){var e=this.data,t=this.onClick;return(0,o.createVNode)("span",{class:"vjs-tree__brackets",onClick:t},[e])}}),T=(0,o.defineComponent)({emits:["change","update:modelValue"],props:{checked:{type:Boolean,default:!1},isMultiple:Boolean,onChange:Function},setup:function(e,t){var n=t.emit;return{uiType:(0,o.computed)(function(){return e.isMultiple?"checkbox":"radio"}),model:(0,o.computed)({get:function(){return e.checked},set:function(a){return n("update:modelValue",a)}})}},render:function(){var e=this.uiType,t=this.model,n=this.$emit;return(0,o.createVNode)("label",{class:["vjs-check-controller",t?"is-checked":""],onClick:function(a){return a.stopPropagation()}},[(0,o.createVNode)("span",{class:"vjs-check-controller__inner is-".concat(e)},null),(0,o.createVNode)("input",{checked:t,class:"vjs-check-controller__original is-".concat(e),type:e,onChange:function(){return n("change",t)}},null)])}});function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,a)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?D(Object(n),!0).forEach(function(a){b(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function I(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function v(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"root",n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,u=a||{},k=u.key,y=u.index,C=u.type,w=C===void 0?"content":C,r=u.showComma,l=r!==void 0&&r,i=u.length,V=i===void 0?1:i,p=I(e);if(p==="array"){var P=e.map(function(O,N,A){return v(O,"".concat(t,"[").concat(N,"]"),n+1,{index:N,showComma:N!==A.length-1,length:V,type:w})}).reduce(function(O,N){return O.concat(N)},[]);return[v("[",t,n,{showComma:!1,key:k,length:e.length,type:"arrayStart"})[0]].concat(P,v("]",t,n,{showComma:l,length:e.length,type:"arrayEnd"})[0])}if(p==="object"){var j=Object.keys(e),M=j.map(function(O,N,A){return v(e[O],O.includes(".")?"".concat(t,'["').concat(O,'"]'):"".concat(t,".").concat(O),n+1,{key:O,showComma:N!==A.length-1,length:V,type:w})}).reduce(function(O,N){return O.concat(N)},[]);return[v("{",t,n,{showComma:!1,key:k,index:y,length:j.length,type:"objectStart"})[0]].concat(M,v("}",t,n,{showComma:l,length:j.length,type:"objectEnd"})[0])}var H=Object.entries({content:e,level:n,key:k,index:y,path:t,showComma:l,length:V,type:w}).reduce(function(O,N){var A=z(N,2),ie=A[0],oe=A[1];return oe!==void 0?$($({},O),{},b({},ie,oe)):O},{});return[H]}function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,a)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Z(Object(n),!0).forEach(function(a){b(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}var G={showLength:{type:Boolean,default:!1},showDoubleQuotes:{type:Boolean,default:!0},customValueFormatter:Function,selectableType:String,showSelectController:{type:Boolean,default:!1},showLine:{type:Boolean,default:!0},selectOnClickNode:{type:Boolean,default:!0},collapsedOnClickBrackets:{type:Boolean,default:!0},pathSelectable:{type:Function,default:function(){return!0}},highlightSelectedNode:{type:Boolean,default:!0}},ne=(0,o.defineComponent)({name:"TreeNode",props:Q(Q({},G),{},{node:{type:Object,required:!0},collapsed:Boolean,checked:Boolean,onTreeNodeClick:{type:Function},onBracketsClick:{type:Function},onSelectedChange:{type:Function}}),setup:function(e,t){var n=t.emit,a=(0,o.computed)(function(){return I(e.node.content)}),u=(0,o.computed)(function(){return"vjs-value vjs-value__".concat(a.value)}),k=(0,o.computed)(function(){return e.showDoubleQuotes?'"'.concat(e.node.key,'"'):e.node.key}),y=(0,o.computed)(function(){return e.selectableType==="multiple"}),C=(0,o.computed)(function(){return e.selectableType==="single"}),w=(0,o.computed)(function(){return e.pathSelectable(e.node.path,e.node.content)&&(y.value||C.value)}),r=function(l){var i=l+"";return a.value==="string"&&(i='"'.concat(i,'"')),i};return{state:(0,o.reactive)({valueClass:u,prettyKey:k,isMultiple:y,selectable:w}),defaultFormatter:r,customFormatter:function(l){return e.customValueFormatter?e.customValueFormatter(l,e.node.key,e.node.path,r(l)):r(l)},onBracketsClickHandler:function(){e.collapsedOnClickBrackets&&n("brackets-click",!e.collapsed,e.node.path)},onCheckedChange:function(){n("selected-change",e.node)},onNodeClick:function(){n("tree-node-click",e.node),w.value&&e.selectOnClickNode&&n("selected-change",e.node)}}},render:function(){var e=this.state,t=this.node,n=this.showSelectController,a=this.highlightSelectedNode,u=this.checked,k=this.showLength,y=this.collapsed,C=this.showLine,w=this.customValueFormatter,r=this.defaultFormatter,l=this.customFormatter,i=this.onNodeClick,V=this.onCheckedChange,p=this.onBracketsClickHandler;return(0,o.createVNode)("div",{class:{"vjs-tree__node":!0,"has-selector":n,"is-highlight":a&&u},onClick:i},[n&&e.selectable&&t.type!=="objectEnd"&&t.type!=="arrayEnd"&&(0,o.createVNode)(T,{isMultiple:e.isMultiple,checked:u,onChange:V},null),Array.from(Array(t.level)).map(function(P,j){return(0,o.createVNode)("div",{key:j,class:{"vjs-tree__indent":!0,"has-line":C}},null)}),t.key&&(0,o.createVNode)("span",{class:"vjs-key"},["".concat(e.prettyKey,": ")]),(0,o.createVNode)("span",null,[t.type!=="content"?(0,o.createVNode)(s,{data:t.content,onClick:p},null):w?(0,o.createVNode)("span",{class:e.valueClass,innerHTML:l(t.content)},null):(0,o.createVNode)("span",{class:e.valueClass},[r(t.content)]),t.showComma&&(0,o.createVNode)("span",null,[","]),k&&y&&(0,o.createVNode)("span",{class:"vjs-comment"},[(0,o.createTextVNode)(" // "),t.length,(0,o.createTextVNode)(" items ")])])])}});function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,a)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?K(Object(n),!0).forEach(function(a){b(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}var L=(0,o.defineComponent)({name:"Tree",props:S(S({},G),{},{data:{type:Object,default:null},deep:{type:Number,default:1/0},deepCollapseChildren:{type:Boolean,default:!1},path:{type:String,default:"root"},virtual:{type:Boolean,default:!1},virtualLines:{type:Number,default:10},itemHeight:{type:Number,default:20},modelValue:{type:[String,Array],default:function(){return""}}}),emits:["click","change","update:modelValue"],setup:function(e,t){var n=t.emit,a=(0,o.ref)(),u=(0,o.reactive)({translateY:0,visibleData:null,hiddenPaths:v(e.data,e.path).reduce(function(r,l){var i=e.deepCollapseChildren?l.level>=e.deep:l.level===e.deep;return l.type!=="objectStart"&&l.type!=="arrayStart"||!i?r:S(S({},r),{},b({},l.path,1))},{})}),k=(0,o.computed)(function(){var r=null;return v(e.data,e.path).reduce(function(l,i,V){var p=S(S({},i),{},{id:V}),P=u.hiddenPaths[p.path];if(r&&r.path===p.path){var j=r.type==="objectStart",M=S(S(S({},r),p),{},{content:j?"{...}":"[...]",type:j?"objectCollapsed":"arrayCollapsed"});return r=null,l.concat(M)}return P&&!r?(r=p,l):r?l:l.concat(p)},[])}),y=(0,o.computed)(function(){var r=e.modelValue;return r&&e.selectableType==="multiple"&&Array.isArray(r)?r:[r]}),C=(0,o.computed)(function(){return!e.selectableType||e.selectOnClickNode||e.showSelectController?"":"When selectableType is not null, selectOnClickNode and showSelectController cannot be false at the same time, because this will cause the selection to fail."}),w=function(r){if(e.virtual){var l=a.value,i=e.virtualLines,V=l&&l.scrollTop||0,p=Math.floor(V/e.itemHeight),P=p<0?0:p+i>r.length?r.length-i:p;P<0&&(P=0);var j=P+i;u.translateY=P*e.itemHeight,u.visibleData=r.filter(function(M,H){return H>=P&&H<j})}else u.visibleData=r};return(0,o.watchEffect)(function(){C.value&&function(r){throw new Error("[VueJSONPretty] ".concat(r))}(C.value)}),(0,o.watchEffect)(function(){k.value&&w(k.value)}),{tree:a,state:u,flatData:k,selectedPaths:y,onTreeScroll:function(){w(k.value)},onSelectedChange:function(r){var l=r.path,i=e.selectableType;if(i==="multiple"){var V=y.value.findIndex(function(M){return M===l}),p=J(y.value);V!==-1?p.splice(V,1):p.push(l),n("update:modelValue",p),n("change",p,J(y.value))}else if(i==="single"&&y.value[0]!==l){var P=z(y.value,1)[0],j=l;n("update:modelValue",j),n("change",j,P)}},onTreeNodeClick:function(r){var l=r.content,i=r.path;n("click",i,l)},onBracketsClick:function(r,l){if(r)u.hiddenPaths=S(S({},u.hiddenPaths),{},b({},l,1));else{var i=S({},u.hiddenPaths);delete i[l],u.hiddenPaths=i}}}},render:function(){var e=this.virtual,t=this.itemHeight,n=this.customValueFormatter,a=this.showDoubleQuotes,u=this.showLength,k=this.showLine,y=this.showSelectController,C=this.selectOnClickNode,w=this.pathSelectable,r=this.highlightSelectedNode,l=this.collapsedOnClickBrackets,i=this.state,V=this.flatData,p=this.selectedPaths,P=this.selectableType,j=this.onTreeNodeClick,M=this.onBracketsClick,H=this.onSelectedChange,O=this.onTreeScroll,N=i.visibleData&&i.visibleData.map(function(A){return(0,o.createVNode)(ne,{key:A.id,node:A,collapsed:!!i.hiddenPaths[A.path],"custom-value-formatter":n,"show-double-quotes":a,"show-length":u,"collapsed-on-click-brackets":l,checked:p.includes(A.path),"selectable-type":P,"show-line":k,"show-select-controller":y,"select-on-click-node":C,"path-selectable":w,"highlight-selected-node":r,onTreeNodeClick:j,onBracketsClick:M,onSelectedChange:H},null)});return(0,o.createVNode)("div",{ref:"tree",class:{"vjs-tree":!0,"is-virtual":e},onScroll:O},[e?(0,o.createVNode)("div",{style:{height:"".concat(V.length*t,"px")}},[(0,o.createVNode)("div",{style:{transform:"translateY(".concat(i.translateY,"px)")}},[N])]):N])}}),W=(0,o.defineComponent)(L)}(),F}()})})(se);var Se=Oe(se.exports);const Ve={class:"outerBox"},Pe={class:"requestForm"},Ne={key:1},Be={key:0,class:"auth-token-container"},Te=te("figma\u6388\u6743"),Fe=te("\u83B7\u53D6\u6570\u636E"),De=te("\u91CD\u65B0\u6388\u6743"),Ae=te("\u5982\u4F55\u83B7\u53D6"),xe=["src"],Ie=ve({setup(d){const m=b=>Object.keys(b).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(b[s])}`).join("&"),h="https://tdoms.woa.com/#/figma",E=R(),q=R(!1),g=R(localStorage.getItem("figmaAuthToken"));ge(async()=>{const b=window.location.search.substring(1).split("&"),s=Object.create(null);for(let T=0;T<b.length;T++){const D=b[T].split("=");D[0]&&(s[D[0]]=D[1]?D[1]:"")}if(s.code&&!g.value){const{state:T,code:D}=s;if(localStorage.getItem("figmaAuthState")!==T)return;const v=await(await fetch(`https://service-kyuf6ars-1257200260.gz.apigw.tencentcs.com/release/figma/auth?${m({code:D,redirectUri:h})}`)).json();g.value=v.data.access_token,localStorage.setItem("figmaAuthToken",g.value)}});const F=R(1),o=be(()=>({token:[{required:F.value!==1,message:"\u8BF7\u8F93\u5165AccessToken"}],fileUrl:[{required:!0,message:"\u8BF7\u8F93\u5165fileUrl"}],ids:[{required:!0,message:"\u8BF7\u8F93\u5165"}]})),c=R({token:"",fileUrl:"",depth:0,havePath:!1,isNodes:!1,ids:""}),B=async({validateResult:b})=>{if(b!==!0)return;q.value=!0;const T=await(await fetch(`https://service-kyuf6ars-1257200260.gz.apigw.tencentcs.com/release/figma/file?${m(ue(le({},c.value),{authToken:g.value,type:F.value===1?"authToken":"personalToken"}))}`)).json();q.value=!1,E.value=T.data},z=(b="")=>{b==="reAuth"&&(localStorage.removeItem("figmaAuthToken"),g.value="");const s=`${Date.now()}`;localStorage.setItem("figmaAuthState",s),window.location.href=`https://www.figma.com/oauth?client_id=Hn8ZQBrB9AOZaGqPTRZ1w9&redirect_uri=${encodeURIComponent(h)}&scope=file_read&state=${s}&response_type=code`},J=()=>{window.open("https://www.figma.com/developers/api#access-tokens")};return(b,s)=>{const T=x("t-tab-panel"),D=x("t-tabs"),$=x("t-input"),I=x("t-button"),v=x("t-form-item"),Z=x("t-input-number"),Q=x("t-switch"),G=x("t-col"),ne=x("t-row"),K=x("t-form"),S=x("t-loading");return U(),X("div",Ve,[ke("div",Pe,[f(D,{modelValue:F.value,"onUpdate:modelValue":s[0]||(s[0]=L=>F.value=L)},{default:_(()=>[f(T,{value:1,label:"Auth"}),f(T,{value:2,label:"AccessToken"})]),_:1},8,["modelValue"]),f(K,{ref:"form",class:"panelInner",data:c.value,rules:ce(o),"label-width":"90px",colon:!0,onSubmit:B},{default:_(()=>{var L,W;return[f(v,{label:"Token",name:"token"},{default:_(()=>[F.value===2?(U(),Y($,{key:0,modelValue:c.value.token,"onUpdate:modelValue":s[1]||(s[1]=e=>c.value.token=e),placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])):(U(),X("div",Ne,[g.value?(U(),X("div",Be,we(g.value),1)):(U(),Y(I,{key:1,theme:"primary",type:"button",onClick:z},{default:_(()=>[Te]),_:1}))]))]),_:1}),f(v,{label:"\u6587\u4EF6\u94FE\u63A5",name:"fileUrl"},{default:_(()=>[f($,{modelValue:c.value.fileUrl,"onUpdate:modelValue":s[2]||(s[2]=e=>c.value.fileUrl=e),placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1}),f(v,{label:"\u6570\u636E\u5C42\u7EA7",name:"depth"},{default:_(()=>[f(Z,{modelValue:c.value.depth,"onUpdate:modelValue":s[3]||(s[3]=e=>c.value.depth=e),placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1}),f(ne,{gutter:16},{default:_(()=>[f(G,{span:6},{default:_(()=>[f(v,{label:"path\u6570\u636E",name:"havePath"},{default:_(()=>[f(Q,{modelValue:c.value.havePath,"onUpdate:modelValue":s[4]||(s[4]=e=>c.value.havePath=e),size:"large",label:["\u5F00","\u5173"]},null,8,["modelValue"])]),_:1})]),_:1}),f(G,{span:6},{default:_(()=>[f(v,{label:"\u83B7\u53D6\u8282\u70B9",name:"isNodes"},{default:_(()=>[f(Q,{modelValue:c.value.isNodes,"onUpdate:modelValue":s[5]||(s[5]=e=>c.value.isNodes=e),size:"large",label:["\u5F00","\u5173"]},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),c.value.isNodes?(U(),Y(v,{key:0,label:"\u8282\u70B9\u8FC7\u6EE4",name:"ids"},{default:_(()=>[f($,{modelValue:c.value.ids,"onUpdate:modelValue":s[6]||(s[6]=e=>c.value.ids=e),placeholder:"\u59820:3,0:1"},null,8,["modelValue"])]),_:1})):ee("",!0),f(v,{style:{"padding-top":"8px"}},{default:_(()=>[f(I,{theme:"primary",type:"submit"},{default:_(()=>[Fe]),_:1}),F.value===1?(U(),Y(I,{key:0,theme:"warning",variant:"outline",type:"button",onClick:s[7]||(s[7]=e=>z("reAuth"))},{default:_(()=>[De]),_:1})):ee("",!0),F.value===2?(U(),Y(I,{key:1,theme:"warning",variant:"outline",type:"button",onClick:J},{default:_(()=>[Ae]),_:1})):ee("",!0)]),_:1}),((L=c.value)==null?void 0:L.fileUrl)&&((W=E.value)==null?void 0:W.thumbnailUrl)?(U(),X("iframe",{key:1,style:{border:"1px solid rgba(0, 0, 0, 0.1)"},width:"460",height:"450",src:`https://www.figma.com/embed?embed_host=share&url=${c.value.fileUrl} `,allowfullscreen:""},null,8,xe)):ee("",!0)]}),_:1},8,["data","rules"])]),f(S,{size:"small",loading:q.value,"show-overlay":""},{default:_(()=>[f(ce(Se),{class:"jsonDiv","deep-collapse-children":!0,deep:3,data:E.value},null,8,["data"])]),_:1},8,["loading"])])}}});export{Ie as default};
